{"version":3,"file":"marionette-form","sources":["marionette-form/src/utils.js","marionette-form/src/behavior.js","marionette-form/src/index.js"],"sourcesContent":["\nimport * as _ from 'lodash'\n\nfunction display (el, value) {\n  el.css('display', (value ? '' : 'none'))\n}\n\nfunction findDropdownViewInRegions (view, name) {\n  var result = null\n  // Search regions if they are available\n  if (view.getRegions) {\n    _.each(view.getRegions(), function (region) {\n      if (region.currentView) {\n        if (region.currentView.name === name) {\n          result = region.currentView\n          return false\n        }\n      }\n    })\n  }\n  // Return the result\n  return result\n}\n\nfunction findDropdownView (view, name) {\n  // Look in the current view\n  var result = findDropdownViewInRegions(view, name)\n  // Look in nested views\n  if (!result) {\n    _.each(view.getRegions(), function (region) {\n      if (region.currentView) {\n        result = findDropdownViewInRegions(region.currentView, name)\n        if (result) { return false }\n      }\n    })\n  }\n  // Return the result\n  return result\n}\n\nexport default {\n  display,\n  findDropdownView\n}\n","\nimport _ from 'lodash'\nimport $ from 'jquery'\n\nimport Marionette from 'marionette'\nimport Validator from 'validator'\n\nimport utils from './utils'\n\nexport default Marionette.Behavior.extend({\n  ui: {\n    selects: 'select'\n  },\n  events: {\n    'submit': 'onSubmit',\n    'input': 'onInput',\n    'change': 'onChange'\n  },\n  initialize: function () {\n    this.errorClass = this.options.errorClass || 'error'\n    this.fieldSelector = this.options.fieldSelector || '.field'\n    this.suppressStates = false\n    this.listenTo(this.view, 'clear', this.clear)\n  },\n  onShow: function () {\n    var data = this.view.serializeData()\n    // Add dropdown icons for select controls\n    this.ui.selects.after('<i class=\"icon-dropdown\" />')\n    // Populate the form with data\n    this.suppressStates = true\n    this.view.$el.find('input, select').each(function (i, el) {\n      var $el = $(el)\n      var value = data[$el.attr('name')]\n      if (value) { $el.val(value).trigger('change') }\n    })\n    this.suppressStates = false\n    this.applyFormStates()\n  },\n  onChange: function (e) {\n    var el = $(e.target)\n    var name = el.attr('name')\n    // Refresh the form state according to the field\n    var state = this.view.states[name]\n    if (state && !this.suppressStates) {\n      this.applyFormStates()\n    }\n    // Validate the form according to the field\n    var rule = this.view.validation[name]\n    if (rule && this.attemptedSubmission) {\n      this.validate()\n    }\n  },\n  onInput: function (e) {\n    var el = $(e.target)\n    var name = el.attr('name')\n    // Validate the form according to the field\n    var rule = this.view.validation[name]\n    if (rule && this.attemptedSubmission) {\n      this.validate()\n    }\n  },\n  onSubmit: function (e) {\n    e.preventDefault()\n    this.view.trigger('attempt')\n    this.attemptedSubmission = true\n    this.validate(function (err, data) {\n      // TODO: Handle error from validator\n      if (err) { console.log(err); return }\n      if (this.view.model) { this.view.model.set(data) }\n      this.attemptedSubmission = false\n      this.view.trigger('submit', data)\n    }.bind(this))\n  },\n  clear: function () {\n    this.attemptedSubmission = false\n    this.suppressStates = true\n    this.view.$el.find('input').each(function (i, el) {\n      var $el = $(el)\n      $el.val('').trigger('change')\n    })\n    this.suppressStates = false\n    this.applyFormStates()\n  },\n  clearErrors: function () {\n    var fields = this.view.$el.find(this.fieldSelector)\n    fields.removeClass(this.errorClass)\n    fields.find('.' + this.errorClass).remove()\n    this.view.trigger('clearErrors')\n  },\n  fieldError: function (error, name) {\n    var el = this.view.$el.find(`[name=${name}]`)\n    var field = el.closest(this.fieldSelector)\n    field.addClass(this.errorClass)\n    this.view.trigger('error', field, error)\n  },\n  validate: function (done) {\n    var formData = this.$el.serializeJSON()\n    var validation = this.view.validation || {}\n    // Filter validators and form data using the current form state\n    var state = this.currentState\n    formData = _.pickBy(formData, function (v, k) { return state[k] })\n    validation = _.pickBy(validation, function (v, k) { return state[k] })\n    // Validate the form data\n    var validator = Validator.Validator(validation)\n    validator.validate(formData, function (err, result) {\n      if (err) { return done(err) }\n      this.clearErrors()\n      if (_.size(result) === 0) {\n        if (done) { return done(null, formData) }\n      } else {\n        // Apply errors to fields\n        _.each(result, _.bind(this.fieldError, this))\n        // Focus on the first field with an error\n        this.$el.find(this.fieldSelector).each(function () {\n          var el = $(this)\n          if (el.hasClass(this.errorClass)) {\n            el.find('input').focus()\n            return false\n          }\n        })\n      }\n    }.bind(this))\n  },\n  alterStateByField: function (display, field) {\n    var el = this.view.$el.find('[name=' + field + ']')\n    var group = el.closest(this.fieldSelector)\n    var parent = el.parent()\n    if (parent.hasClass('dropdown')) {\n      var view = utils.findDropdownView(this.view, field)\n      if (_.isArray(display)) {\n        utils.display(group, true)\n        if (view) { view.setVisibleOptions(display) }\n      } else {\n        utils.display(group, display)\n      }\n    } else if (el.is('select')) {\n      if (_.isObject(display)) {\n        _.each(display, function (v, k) {\n          utils.display(el.find('[value=' + k + ']'), display)\n        })\n      } else {\n        utils.display(group, display)\n        utils.display(el.find('option'), display)\n      }\n    } else {\n      utils.display(group, display)\n    }\n  },\n  applyFormStates: function () {\n    var modelData = this.view.serializeData()\n    var formData = this.$el.serializeJSON()\n    var data = _.extend(modelData, formData)\n    var result = {}\n    // Include all inputs in initial state\n    this.$el.find('input').each(function (i, o) {\n      if (o.name) { result[o.name] = true }\n    })\n    // Determine the current form state\n    _.each(this.view.states, function (state, field) {\n      if (result[field] !== false) {\n        var value = data[field]\n        if (value !== undefined) {\n          _.each(state[value], function (v, k) {\n            if (_.isBoolean(result[k]) && _.isBoolean(v)) {\n              result[k] = result[k] && v\n            } else if (_.isBoolean(result[k]) && _.isArray(v)) {\n              result[k] = v\n            } else if (_.isArray(result[k]) && _.isArray(v)) {\n              result[k] = _.intersection(result[k], v)\n            } else {\n              result[k] = v\n            }\n          })\n        }\n      }\n    })\n    // Apply compiled state\n    _.each(result, this.alterStateByField.bind(this))\n    // Determine the complete state\n    var state = _.clone(result)\n    // Exclude indicated fields\n    var exclude = this.view.exclude || {}\n    _.each(exclude, function (o) { state[o] = false })\n    // Store the complete state\n    this.currentState = state\n  }\n})\n","\nimport FormBehavior from './behavior'\n\nexport default {\n  FormBehavior\n}\n"],"names":["display","el","value","css","findDropdownViewInRegions","view","name","result","getRegions","_","each","region","currentView","findDropdownView","Marionette","Behavior","extend","ui","selects","events","initialize","errorClass","options","fieldSelector","suppressStates","listenTo","clear","onShow","data","serializeData","after","$el","find","i","$","attr","val","trigger","applyFormStates","onChange","e","target","state","states","rule","validation","attemptedSubmission","validate","onInput","onSubmit","preventDefault","err","console","log","model","set","bind","clearErrors","fields","removeClass","remove","fieldError","error","field","closest","addClass","done","formData","serializeJSON","currentState","pickBy","v","k","validator","Validator","size","hasClass","focus","alterStateByField","group","parent","utils","isArray","setVisibleOptions","is","isObject","modelData","o","undefined","isBoolean","intersection","clone","exclude","FormBehavior"],"mappings":"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"}