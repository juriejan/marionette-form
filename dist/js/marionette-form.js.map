{"version":3,"file":"marionette-form.js","sources":["../../src/utils.js","../../src/behavior.js","../../src/index.js"],"sourcesContent":["\nimport * as _ from 'lodash'\n\nfunction findDropdownViewInRegions (view, name) {\n  var result = null\n  // Search regions if they are available\n  if (view.getRegions) {\n    _.each(view.getRegions(), function (region) {\n      if (region.currentView) {\n        if (region.currentView.name === name) {\n          result = region.currentView\n          return false\n        }\n      }\n    })\n  }\n  // Return the result\n  return result\n}\n\nfunction findDropdownView (view, name) {\n  // Look in the current view\n  var result = findDropdownViewInRegions(view, name)\n  // Look in nested views\n  if (!result) {\n    _.each(view.getRegions(), function (region) {\n      if (region.currentView) {\n        result = findDropdownViewInRegions(region.currentView, name)\n        if (result) { return false }\n      }\n    })\n  }\n  // Return the result\n  return result\n}\n\nexport default {\n  findDropdownView\n}\n","\nimport _ from 'lodash'\nimport $ from 'jquery'\n\nimport Marionette from 'marionette'\nimport Validator from 'validator'\n\nimport utils from './utils'\n\nexport default Marionette.Behavior.extend({\n  ui: {\n    selects: 'select'\n  },\n  events: {\n    'submit': 'onSubmit',\n    'input': 'onInput',\n    'change': 'onChange'\n  },\n  initialize: function () {\n    this.errorClass = this.options.errorClass || 'error'\n    this.fieldSelector = this.options.fieldSelector || '.field'\n    this.suppressStates = false\n    this.listenTo(this.view, 'clear', this.clear)\n  },\n  onShow: function () {\n    var data = this.view.serializeData()\n    // Add dropdown icons for select controls\n    this.ui.selects.after('<i class=\"icon-dropdown\" />')\n    // Populate the form with data\n    this.suppressStates = true\n    this.view.$el.find('input, select').each(function (i, el) {\n      var $el = $(el)\n      var value = data[$el.attr('name')]\n      if (value) { el.val(value).trigger('change') }\n    })\n    this.suppressStates = false\n    this.applyFormStates()\n  },\n  onChange: function (e) {\n    var el = $(e.target)\n    var name = el.attr('name')\n    // Refresh the form state according to the field\n    var state = this.view.states[name]\n    if (state && !this.suppressStates) {\n      this.applyFormStates()\n    }\n    // Validate the form according to the field\n    var rule = this.view.validation[name]\n    if (rule && this.attemptedSubmission) {\n      this.validate()\n    }\n  },\n  onInput: function (e) {\n    var el = $(e.target)\n    var name = el.attr('name')\n    // Validate the form according to the field\n    var rule = this.view.validation[name]\n    if (rule && this.attemptedSubmission) {\n      this.validate()\n    }\n  },\n  onSubmit: function (e) {\n    e.preventDefault()\n    this.view.trigger('attempt')\n    this.attemptedSubmission = true\n    this.validate(function (err, data) {\n      // TODO: Handle error from validator\n      if (err) { console.log(err); return }\n      if (this.view.model) { this.view.model.set(data) }\n      this.attemptedSubmission = false\n      this.view.trigger('submit', data)\n    }.bind(this))\n  },\n  clear: function () {\n    this.attemptedSubmission = false\n    this.suppressStates = true\n    this.view.$el.find('input').each(function (i, el) {\n      var $el = $(el)\n      $el.val('').trigger('change')\n    })\n    this.suppressStates = false\n    this.applyFormStates()\n  },\n  clearErrors: function () {\n    var fields = this.view.$el.find(this.fieldSelector)\n    fields.removeClass(this.errorClass)\n    fields.find('.' + this.errorClass).remove()\n  },\n  fieldError: function (error, name) {\n    var el = this.view.$el.find(`[name=${name}]`)\n    var field = el.closest(this.fieldSelector)\n    this.view.trigger('error', field, error)\n  },\n  validate: function (done) {\n    var formData = this.$el.serializeJSON()\n    var validation = this.view.validation || {}\n    // Filter validators and form data using the current form state\n    var state = this.currentState\n    formData = _.pick(formData, function (v, k) { return state[k] })\n    validation = _.pick(validation, function (v, k) { return state[k] })\n    // Validate the form data\n    var validator = Validator.Validator(validation)\n    validator.validate(formData, function (err, result) {\n      if (err) { return done(err) }\n      this.clearErrors()\n      if (_.size(result) === 0) {\n        if (done) { return done(null, formData) }\n      } else {\n        // Apply errors to fields\n        _.each(result, _.bind(this.fieldError, this))\n        // Focus on the first field with an error\n        this.$el.find(this.fieldSelector).each(function () {\n          var el = $(this)\n          if (el.hasClass(this.errorClass)) {\n            el.find('input').focus()\n            return false\n          }\n        })\n      }\n    }.bind(this))\n  },\n  alterStateByField: function (display, field) {\n    var el = this.view.$el.find('[name=' + field + ']')\n    var group = el.closest(this.fieldSelector)\n    var parent = el.parent()\n    if (parent.hasClass('dropdown')) {\n      var view = utils.findDropdownView(this.view, field)\n      if (_.isArray(display)) {\n        group.toggle(true)\n        if (view) { view.setVisibleOptions(display) }\n      } else {\n        group.toggle(!!display)\n        if (display && view) { view.refresh() }\n      }\n    } else if (el.is('select')) {\n      if (_.isObject(display)) {\n        _.each(display, function (v, k) {\n          el.find('[value=' + k + ']').toggle(v)\n        })\n      } else {\n        group.toggle(!!display)\n        el.find('option').toggle(!!display)\n      }\n    } else {\n      group.toggle(!!display)\n    }\n  },\n  applyFormStates: function () {\n    var modelData = this.view.serializeData()\n    var formData = this.$el.serializeJSON()\n    var data = _.extend(modelData, formData)\n    var result = {}\n    // Include all inputs in initial state\n    this.$el.find('input').each(function (i, o) {\n      if (o.name) { result[o.name] = true }\n    })\n    // Determine the current form state\n    _.each(this.view.states, function (state, field) {\n      if (result[field] !== false) {\n        var value = data[field]\n        if (value !== undefined) {\n          _.each(state[value], function (v, k) {\n            if (_.isBoolean(result[k]) && _.isBoolean(v)) {\n              result[k] = result[k] && v\n            } else if (_.isBoolean(result[k]) && _.isArray(v)) {\n              result[k] = v\n            } else if (_.isArray(result[k]) && _.isArray(v)) {\n              result[k] = _.intersection(result[k], v)\n            } else {\n              result[k] = v\n            }\n          })\n        }\n      }\n    })\n    // Apply compiled state\n    _.each(result, this.alterStateByField.bind(this))\n    // Determine the complete state\n    var state = _.clone(result)\n    // Exclude indicated fields\n    var exclude = this.view.exclude || {}\n    _.each(exclude, function (o) { state[o] = false })\n    // Store the complete state\n    this.currentState = state\n  }\n})\n","\nimport FormBehavior from './behavior'\n\nexport default {\n  FormBehavior\n}\n"],"names":[],"mappings":"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"}